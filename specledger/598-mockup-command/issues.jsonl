{"id":"SL-675f7d","title":"Mockup Command","description":"Add sl mockup [spec-name] and sl mockup update commands with an interactive TUI flow matching sl revise. Auto-detects spec from branch, guides user through framework detection, design system setup, component selection, and format choice, builds an AI agent prompt, launches the agent to generate mockups (HTML or JSX), and offers post-agent commit/push. Shared editor/prompt utilities extracted from revise into pkg/cli/prompt/. Extends sl init for frontend projects.","status":"open","priority":1,"issue_type":"epic","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:07.093033+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","component:cli","component:mockup","component:prompt"]}
{"id":"SL-a1b2c3","title":"Phase 1: Shared Infrastructure - Extract prompt/editor from revise","description":"Extract shared editor and prompt utilities from pkg/cli/revise/ into a new reusable pkg/cli/prompt/ package. Refactor revise to delegate to the shared package. This enables both revise and mockup to share editor integration, template rendering, and token estimation. Implements FR-020.","status":"open","priority":1,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","blocks":["SL-f7a8b9"],"labels":["spec:598-mockup-command","phase:shared-infra","requirement:FR-020"],"parentId":"SL-675f7d"}
{"id":"SL-acaa90","title":"Phase 2: Setup - Package and Command Skeleton","description":"Initialize the pkg/cli/mockup/ domain package with shared types (including MockupPromptContext, PromptComponent, SpecContent) and create the Cobra command skeleton with all flags (--format, --force, --dry-run, --summary, --json). Register VarMockupCmd in cmd/sl/main.go. Spec-name argument is optional.","status":"open","priority":1,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:13.016607+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","blocks":["SL-e6485b"],"labels":["spec:598-mockup-command","phase:setup"],"parentId":"SL-675f7d"}
{"id":"SL-e6485b","title":"Phase 3: Domain Logic - Detector, Scanner, Design System, Spec Parser","description":"Core domain logic that all user stories depend on: frontend framework detector (tiered heuristics), component scanner (glob + regex per framework), design system file I/O (YAML frontmatter + markdown parsing/writing), and spec parser (extract SpecContent from spec.md).","status":"open","priority":1,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:18.356017+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","blocked_by":["SL-acaa90"],"blocks":["SL-d4e5f6","SL-f7a8b9","SL-a00981","SL-b0f5d0"],"labels":["spec:598-mockup-command","phase:domain"],"parentId":"SL-675f7d"}
{"id":"SL-d4e5f6","title":"Phase 4: Prompt and Template - Prompt builder, template, golden tests","description":"Create the AI agent prompt template (prompt.tmpl), implement MockupPromptContext builder that assembles context from gathered data and renders the template, and add golden file tests to verify prompt output for various contexts (React HTML, React JSX, Vue HTML, empty components).","status":"open","priority":1,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","blocked_by":["SL-e6485b"],"blocks":["SL-f7a8b9"],"labels":["spec:598-mockup-command","phase:prompt"],"parentId":"SL-675f7d"}
{"id":"SL-f7a8b9","title":"Phase 5: Interactive Flow - Full 10-step wiring in mockup.go","description":"Wire the complete interactive flow: spec resolution (arg/branch/picker), framework detection with confirmation, design system check/generate, component multi-select, format selection, prompt generation, editor review with action menu, agent launch with fallback, post-agent commit/push, and summary. Implements FR-016 through FR-019.","status":"open","priority":1,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","blocked_by":["SL-a1b2c3","SL-d4e5f6","SL-e6485b"],"blocks":["SL-c71d1f"],"labels":["spec:598-mockup-command","phase:interactive","story:US1","requirement:FR-016","requirement:FR-017","requirement:FR-018","requirement:FR-019"],"parentId":"SL-675f7d"}
{"id":"SL-a00981","title":"Phase 6: Update Command - sl mockup update handler","description":"sl mockup update rescans the codebase with interactive confirmation, preserves manual edits, adds new components, removes stale entries, and writes the updated design_system.md.","status":"open","priority":2,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:39.214755+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","blocked_by":["SL-e6485b"],"blocks":["SL-c71d1f"],"labels":["spec:598-mockup-command","phase:update","story:US4"],"parentId":"SL-675f7d"}
{"id":"SL-b0f5d0","title":"Phase 7: Init Integration - Initialize Design System During Onboarding","description":"Extend sl init/bootstrap flow to detect frontend projects and auto-create specledger/design_system.md during onboarding. Interactive prompt in TUI mode, auto-create in CI mode.","status":"open","priority":3,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:45.562713+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","blocked_by":["SL-e6485b"],"labels":["spec:598-mockup-command","phase:init","story:US5"],"parentId":"SL-675f7d"}
{"id":"SL-c71d1f","title":"Phase 8: Polish - JSON Output, Edge Cases, Tests","description":"Cross-cutting concerns: --json non-interactive path for both commands, comprehensive error messages (agent not found, mockup exists, user cancel, malformed design system), edge case handling, and unit tests for all domain logic including prompt package.","status":"open","priority":3,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:51.025969+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","blocked_by":["SL-f7a8b9","SL-a00981"],"labels":["spec:598-mockup-command","phase:polish"],"parentId":"SL-675f7d"}
{"id":"SL-1e3e83","title":"Phase 3: US1 - Generate Mockup from Spec Using Design System [SUPERSEDED]","description":"SUPERSEDED by Phase 4 (SL-d4e5f6) and Phase 5 (SL-f7a8b9). The non-interactive generator approach was replaced by an interactive TUI flow with AI agent-driven mockup generation.","status":"closed","priority":1,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:23.684618+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","phase:us1","story:US1","superseded"],"parentId":"SL-675f7d"}
{"id":"SL-520c1b","title":"Phase 4: US2 - Auto-Create Design System Index When Missing [SUPERSEDED]","description":"SUPERSEDED. Auto-create logic is now part of the interactive flow in Phase 5 (SL-f7a8b9, task T012). The design system generation is handled as an interactive step within the main mockup flow.","status":"closed","priority":2,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:28.604813+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","phase:us2","story:US2","superseded"],"parentId":"SL-675f7d"}
{"id":"SL-2b6615","title":"Phase 5: US3 - Frontend Detection and Design System Init [SUPERSEDED]","description":"SUPERSEDED. Frontend detection with interactive confirmation is now task T011 in Phase 5 (SL-f7a8b9). The --force bypass and ambiguous repo handling are included in that task.","status":"closed","priority":2,"issue_type":"feature","spec_context":"598-mockup-command","created_at":"2026-02-27T10:00:34.207838+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","phase:us3","story:US3","superseded"],"parentId":"SL-675f7d"}
{"id":"SL-c0d1e2","title":"T000: Extract shared editor utilities into pkg/cli/prompt/editor.go","description":"WHY: Both revise and mockup commands need editor integration (DetectEditor, EditPrompt). Extracting shared utilities avoids duplication and ensures consistent UX (FR-020).\n\nDESIGN: Create pkg/cli/prompt/editor.go. Move DetectEditor() and EditPrompt() from pkg/cli/revise/editor.go into the new package. DetectEditor checks $EDITOR, $VISUAL env vars with fallback to common editors (vi, nano, vim). EditPrompt creates a temp file, opens editor as subprocess with TTY passthrough, reads edited content. Keep the same function signatures.\n\nACCEPTANCE: pkg/cli/prompt/editor.go compiles. DetectEditor and EditPrompt work identically to the revise versions.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/prompt/editor.go created with DetectEditor and EditPrompt\n[ ] Functions work identically to revise/editor.go originals\n[ ] Package compiles with go build ./pkg/cli/prompt/...","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"pkg/cli/prompt/editor.go created","checked":false},{"item":"DetectEditor function moved","checked":false},{"item":"EditPrompt function moved","checked":false},{"item":"Package compiles","checked":false}]},"blocks":["SL-e6f7a8"],"labels":["spec:598-mockup-command","phase:shared-infra","component:prompt","requirement:FR-020"],"design":"File: pkg/cli/prompt/editor.go (new). Move from pkg/cli/revise/editor.go. Same function signatures.","acceptance_criteria":"Shared editor utilities compile and work identically to revise originals.","parentId":"SL-a1b2c3"}
{"id":"SL-f3a4b5","title":"T000b: Extract shared prompt utilities into pkg/cli/prompt/prompt.go","description":"WHY: Template rendering, token estimation, and token warnings are needed by both revise and mockup (FR-020).\n\nDESIGN: Create pkg/cli/prompt/prompt.go. Extract RenderTemplate (generic Go template renderer), EstimateTokens (~3.5 chars/token heuristic), and PrintTokenWarnings from pkg/cli/revise/prompt.go. RenderTemplate should accept any template string + any data interface{} and return rendered string. Keep revise-specific functions (BuildRevisionContext) in revise.\n\nACCEPTANCE: pkg/cli/prompt/prompt.go compiles. RenderTemplate can render arbitrary Go templates. EstimateTokens and PrintTokenWarnings work identically.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/prompt/prompt.go created\n[ ] RenderTemplate function (generic Go template renderer)\n[ ] EstimateTokens function (token estimation)\n[ ] PrintTokenWarnings function\n[ ] Package compiles","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"pkg/cli/prompt/prompt.go created","checked":false},{"item":"RenderTemplate function (generic)","checked":false},{"item":"EstimateTokens function","checked":false},{"item":"PrintTokenWarnings function","checked":false},{"item":"Package compiles","checked":false}]},"blocks":["SL-e6f7a8"],"labels":["spec:598-mockup-command","phase:shared-infra","component:prompt","requirement:FR-020"],"design":"File: pkg/cli/prompt/prompt.go (new). Extract from pkg/cli/revise/prompt.go. Generic template rendering.","acceptance_criteria":"Shared prompt utilities compile and provide generic template rendering.","parentId":"SL-a1b2c3"}
{"id":"SL-e6f7a8","title":"T000c: Refactor revise to delegate to pkg/cli/prompt/","description":"WHY: After extracting shared utilities, revise must delegate to the shared package to avoid duplication (FR-020).\n\nDESIGN: Modify pkg/cli/revise/editor.go to become a thin wrapper that imports and calls prompt.DetectEditor() and prompt.EditPrompt(). Modify pkg/cli/revise/prompt.go to delegate RenderPrompt to prompt.RenderTemplate with the revise-specific template. Keep revise-specific functions (BuildRevisionContext, etc.) in revise. All existing revise tests must still pass.\n\nACCEPTANCE: All existing revise tests pass unchanged. revise/editor.go and revise/prompt.go delegate to pkg/cli/prompt/. No duplicate logic.\n\nDEFINITION OF DONE:\n[ ] revise/editor.go delegates to prompt.DetectEditor and prompt.EditPrompt\n[ ] revise/prompt.go delegates to prompt.RenderTemplate\n[ ] All existing revise tests pass unchanged\n[ ] No duplicate logic between revise and prompt packages","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"revise/editor.go delegates to prompt package","checked":false},{"item":"revise/prompt.go delegates to prompt package","checked":false},{"item":"All existing revise tests pass","checked":false},{"item":"No duplicate logic","checked":false}]},"blocked_by":["SL-c0d1e2","SL-f3a4b5"],"labels":["spec:598-mockup-command","phase:shared-infra","component:prompt","component:revise","requirement:FR-020"],"design":"Files: pkg/cli/revise/editor.go (modify), pkg/cli/revise/prompt.go (modify). Thin wrappers importing pkg/cli/prompt/.","acceptance_criteria":"Revise delegates to shared prompt package. All tests pass.","parentId":"SL-a1b2c3"}
{"id":"SL-462fc9","title":"T001: Create shared types in pkg/cli/mockup/types.go","description":"WHY: All domain logic files depend on shared type definitions. This must be created first as the foundation for the entire mockup package.\n\nDESIGN: Create pkg/cli/mockup/types.go with all types from data-model.md: FrameworkType enum (react, nextjs, vue, nuxt, svelte, sveltekit, angular, unknown), DetectionResult struct, Component struct, PropInfo struct, DesignSystem struct, MockupFormat enum (html, jsx), Mockup struct, Screen struct, ComponentRef struct, ScanResult struct, ScanError struct, MockupPromptContext struct (SpecName, SpecContent, Framework, Format, OutputPath, Components []PromptComponent, ExternalLibs, HasDesignSystem), PromptComponent struct (Name, FilePath, Description, Props string, IsExternal, Library), SpecContent struct (Title, UserStories, Requirements, FullContent). Follow existing patterns in pkg/models/ for struct tags (yaml + json). Include validation constants (MinConfidence=70, SchemaVersion=1).\n\nACCEPTANCE: All types from data-model.md are defined including new prompt-related types. Package compiles.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/mockup/types.go created with all entity types from data-model.md\n[ ] FrameworkType enum with all 8 framework constants\n[ ] MockupPromptContext, PromptComponent, SpecContent structs defined\n[ ] All structs have yaml and json struct tags\n[ ] Package compiles with go build ./pkg/cli/mockup/...","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:01:09.616506+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"pkg/cli/mockup/types.go created with all entity types","checked":false},{"item":"FrameworkType enum with all 8 framework constants","checked":false},{"item":"MockupPromptContext, PromptComponent, SpecContent structs","checked":false},{"item":"All structs have yaml and json struct tags","checked":false},{"item":"Package compiles with go build","checked":false}]},"blocks":["SL-001c77","SL-9c05bf","SL-dd3052"],"labels":["spec:598-mockup-command","phase:setup","component:mockup"],"design":"File: pkg/cli/mockup/types.go. Reference: specledger/598-mockup-command/data-model.md for all type definitions. Follow struct tag patterns from pkg/models/.","acceptance_criteria":"All types from data-model.md are defined including prompt-related types and the package compiles successfully.","parentId":"SL-acaa90"}
{"id":"SL-da1182","title":"T002: Create mockup command skeleton and register in main.go","description":"WHY: The Cobra command definitions are the entry point for sl mockup [spec-name] and sl mockup update. Without the command skeleton, no user-facing functionality can be wired.\n\nDESIGN: Create pkg/cli/commands/mockup.go following existing patterns from issue.go and revise.go. Define VarMockupCmd with Use: mockup [spec-name], Args: cobra.MaximumNArgs(1) (spec-name is optional). Define mockupUpdateCmd as subcommand. Add package-level flag vars: mockupForceFlag (bool, -f), mockupJSONFlag (bool), mockupFormatFlag (string, default html), mockupDryRunFlag (bool), mockupSummaryFlag (bool). Register subcommand in init(). Add rootCmd.AddCommand(commands.VarMockupCmd) in cmd/sl/main.go init(). RunE handlers should be stubs returning nil initially.\n\nACCEPTANCE: sl mockup --help shows correct usage text matching contracts/cli.md (spec-name optional). sl mockup update --help shows correct usage text. All 5 flags present. Command is registered and accessible.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/commands/mockup.go created with VarMockupCmd and mockupUpdateCmd\n[ ] Spec-name argument is optional (cobra.MaximumNArgs(1))\n[ ] Flag variables: mockupForceFlag, mockupJSONFlag, mockupFormatFlag, mockupDryRunFlag, mockupSummaryFlag\n[ ] VarMockupCmd registered in cmd/sl/main.go\n[ ] sl mockup --help outputs correct help text matching contracts/cli.md\n[ ] sl mockup update --help outputs correct help text","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:01:22.751379+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"pkg/cli/commands/mockup.go created with VarMockupCmd","checked":false},{"item":"Spec-name optional with MaximumNArgs(1)","checked":false},{"item":"All 5 flags defined (format, force, dry-run, summary, json)","checked":false},{"item":"VarMockupCmd registered in cmd/sl/main.go","checked":false},{"item":"Help text matches contracts/cli.md","checked":false}]},"blocks":["SL-a2b3c4"],"labels":["spec:598-mockup-command","phase:setup","component:cli","requirement:FR-014","requirement:FR-015","requirement:FR-016"],"design":"File: pkg/cli/commands/mockup.go (new), cmd/sl/main.go (modify). Reference: contracts/cli.md for help text. Follow patterns from pkg/cli/commands/issue.go.","acceptance_criteria":"sl mockup --help and sl mockup update --help show correct usage with all flags matching contracts/cli.md","parentId":"SL-acaa90"}
{"id":"SL-001c77","title":"T003: Implement frontend framework detector","description":"WHY: Frontend detection is the first step in the mockup command flow. All user stories depend on knowing whether the project is a frontend project and which framework it uses (FR-001, FR-008).\n\nDESIGN: Create pkg/cli/mockup/detector.go with DetectFramework(projectPath string) (*DetectionResult, error). Implement tiered detection: Tier 1 checks config files (next.config.js/ts/mjs -> nextjs 99%, angular.json -> angular 98%, svelte.config.js -> sveltekit 97%, nuxt.config.js/ts -> nuxt 97%, vite.config.js + .vue -> vue 95%). Tier 2 parses package.json dependencies/devDependencies for react/react-dom, vue, @angular/core, svelte. Tier 3 scans for file extensions .tsx/.jsx, .vue, .svelte, .component.ts. Set IsFrontend=true only if Confidence>=70. Populate ComponentDirs. Skip node_modules, vendor, .git, dist, build. Add Ambiguous bool for monorepo detection (backend + frontend indicators both present).\n\nACCEPTANCE: DetectFramework correctly identifies React, Next.js, Vue, Nuxt, Svelte, SvelteKit, and Angular projects. Returns IsFrontend=false for non-frontend projects. Ambiguous detection for monorepos.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/mockup/detector.go created with DetectFramework function\n[ ] Tier 1 config file detection for all frameworks\n[ ] Tier 2 package.json dependency parsing\n[ ] Tier 3 file extension scanning\n[ ] Ambiguous bool for monorepo detection\n[ ] Returns FrameworkUnknown with IsFrontend=false for non-frontend projects","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:01:39.749813+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"DetectFramework function with 3-tier detection","checked":false},{"item":"All frameworks detected from config files","checked":false},{"item":"package.json fallback parsing","checked":false},{"item":"File extension scan as last resort","checked":false},{"item":"Ambiguous monorepo detection","checked":false},{"item":"IsFrontend=false for non-frontend projects","checked":false}]},"blocked_by":["SL-462fc9"],"blocks":["SL-d5e6f7","SL-078da6"],"labels":["spec:598-mockup-command","phase:domain","component:mockup","requirement:FR-001","requirement:FR-008"],"design":"File: pkg/cli/mockup/detector.go. Reference: research.md Decision 1 for heuristics.","acceptance_criteria":"Correctly identifies all frameworks. Returns false for non-frontend. Ambiguous detection for monorepos.","parentId":"SL-e6485b"}
{"id":"SL-9c05bf","title":"T004: Implement component scanner with framework-specific handlers","description":"WHY: The component scanner discovers UI components in the codebase to populate the design system index (FR-005, FR-008, FR-012).\n\nDESIGN: Create pkg/cli/mockup/scanner.go with ScanComponents(projectPath string, framework FrameworkType) (*ScanResult, error). Implement framework-specific scanning. React/Next.js: glob **/*.{tsx,jsx}; identify via export default + JSX returns; extract props. Vue: glob **/*.vue; identify via <template> tag; extract defineProps. Svelte: glob **/*.svelte; extract export let props. Angular: glob **/*.component.ts; identify via @Component decorator; extract @Input() props. Skip excluded dirs. Add third-party library detection via import patterns for known UI libraries (@mui/material, antd, @chakra-ui/react, @headlessui/react, @radix-ui/react-*). Track ScanDuration and FilesScanned.\n\nACCEPTANCE: Scans React, Vue, Svelte, Angular projects and returns Component structs. Detects third-party library usage. Skips excluded directories.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/mockup/scanner.go with ScanComponents function\n[ ] Per-framework scanning (React, Vue, Svelte, Angular)\n[ ] Props extraction for each framework\n[ ] Third-party library detection (MUI, Ant Design, Chakra, etc.)\n[ ] Excluded directories skipped\n[ ] ScanResult with duration and file count","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:01:59.046667+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"ScanComponents function with framework-specific handlers","checked":false},{"item":"React/Next.js scanning","checked":false},{"item":"Vue, Svelte, Angular scanning","checked":false},{"item":"Props extraction per framework","checked":false},{"item":"Third-party library detection","checked":false},{"item":"Excluded directories skipped","checked":false}]},"blocked_by":["SL-462fc9"],"blocks":["SL-a8b9c0"],"labels":["spec:598-mockup-command","phase:domain","component:mockup","requirement:FR-005","requirement:FR-008"],"design":"File: pkg/cli/mockup/scanner.go. Uses filepath.Glob, os.ReadFile, regexp for content analysis.","acceptance_criteria":"Scans 4 framework types, returns Component structs with third-party detection, skips excluded dirs.","parentId":"SL-e6485b"}
{"id":"SL-dd3052","title":"T005: Implement design system file I/O with YAML frontmatter","description":"WHY: The design system index (specledger/design_system.md) is the central artifact read by the prompt builder and written by the scanner (FR-002, FR-003, FR-010).\n\nDESIGN: Create pkg/cli/mockup/designsystem.go with: LoadDesignSystem(path string) (*DesignSystem, error), WriteDesignSystem(path string, ds *DesignSystem) error, InitializeDesignSystem(projectPath string, detection *DetectionResult) error, MergeDesignSystem(existing *DesignSystem, scanned *ScanResult) (*DesignSystem, MergeStats). Use --- delimiters for YAML frontmatter. Respect <!-- MANUAL --> markers. MergeStats tracks Added, Removed, Unchanged.\n\nACCEPTANCE: Round-trip load/write produces equivalent output. Manual sections preserved across updates. Handles missing/empty/malformed files gracefully.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/mockup/designsystem.go created\n[ ] LoadDesignSystem parses YAML frontmatter + markdown body\n[ ] WriteDesignSystem renders back to markdown with frontmatter\n[ ] InitializeDesignSystem orchestrates scan and write\n[ ] MergeDesignSystem with diff logic and MergeStats\n[ ] Manual section markers preserved on round-trip\n[ ] Graceful handling of missing/empty/malformed files","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:02:12.442695+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"LoadDesignSystem with YAML frontmatter parsing","checked":false},{"item":"WriteDesignSystem with markdown rendering","checked":false},{"item":"InitializeDesignSystem orchestration","checked":false},{"item":"MergeDesignSystem with MergeStats","checked":false},{"item":"Manual section preservation","checked":false},{"item":"Edge case handling","checked":false}]},"blocked_by":["SL-462fc9"],"blocks":["SL-a8b9c0","SL-354a9b","SL-078da6"],"labels":["spec:598-mockup-command","phase:domain","component:mockup","requirement:FR-002","requirement:FR-003","requirement:FR-010"],"design":"File: pkg/cli/mockup/designsystem.go. Uses gopkg.in/yaml.v3 for frontmatter, strings/regexp for markdown.","acceptance_criteria":"Round-trip load/write equivalent. Manual sections preserved. Edge cases handled.","parentId":"SL-e6485b"}
{"id":"SL-0b1e92","title":"T006: Implement spec parser to extract SpecContent","description":"WHY: The prompt builder needs structured data from spec.md to build the AI agent prompt. Must extract title, user stories, requirements, and full content into a SpecContent struct (FR-004).\n\nDESIGN: Create pkg/cli/mockup/specparser.go with ParseSpec(specPath string) (*SpecContent, error). Read spec.md file. Extract: Title from first H1 heading, UserStories from ### User Story sections (as string summaries), Requirements from ### Functional Requirements section (FR-NNN lines), FullContent as raw markdown fallback. Handle edge case: no user stories found -> return specific error for FR-009.\n\nACCEPTANCE: Parses the spec.md format used in this project. Extracts all structured content into SpecContent. Returns error when no user stories found.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/mockup/specparser.go created with ParseSpec function\n[ ] Title extraction from H1 heading\n[ ] UserStories extraction from ### User Story sections\n[ ] Requirements extraction from FR lines\n[ ] FullContent populated as fallback\n[ ] Returns descriptive error when no user stories found (FR-009)","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:02:26.307506+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"ParseSpec function in specparser.go","checked":false},{"item":"Title extraction from H1","checked":false},{"item":"UserStories extraction","checked":false},{"item":"Requirements extraction","checked":false},{"item":"FullContent fallback","checked":false},{"item":"Error on no user stories (FR-009)","checked":false}]},"blocked_by":["SL-462fc9"],"blocks":["SL-b7c8d9"],"labels":["spec:598-mockup-command","phase:domain","story:US1","component:mockup","requirement:FR-004","requirement:FR-009"],"design":"File: pkg/cli/mockup/specparser.go. Uses os.ReadFile, regexp for section extraction. Returns SpecContent struct.","acceptance_criteria":"Parses spec.md format, extracts structured SpecContent, returns error when empty.","parentId":"SL-e6485b"}
{"id":"SL-a7b8c9","title":"T007: Create mockup prompt template (prompt.tmpl)","description":"WHY: The AI agent needs a structured prompt with spec content, design system components, framework info, and output format instructions to generate a quality mockup.\n\nDESIGN: Create pkg/cli/mockup/prompt.tmpl as an embedded Go template. The template should include: agent role/instructions header, spec content section (title, user stories, requirements), design system components section (name, path, description, props for each selected component), external libraries section, framework and format constraints, output path instruction, and quality guidelines (use existing components, follow framework conventions, produce valid HTML/JSX). Use Go template syntax with {{ .FieldName }} referencing MockupPromptContext fields.\n\nACCEPTANCE: Template renders correctly with MockupPromptContext data. Output is a well-structured agent prompt in markdown format. Template is embedded in the binary via //go:embed.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/mockup/prompt.tmpl created with agent instructions\n[ ] Spec content section with title, stories, requirements\n[ ] Component listing section with props\n[ ] Framework and format constraints\n[ ] Output path instruction\n[ ] Template embedded via //go:embed","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"prompt.tmpl created with structured sections","checked":false},{"item":"Spec content section","checked":false},{"item":"Component listing with props","checked":false},{"item":"Framework/format constraints","checked":false},{"item":"Embedded via //go:embed","checked":false}]},"blocked_by":["SL-462fc9"],"blocks":["SL-b7c8d9"],"labels":["spec:598-mockup-command","phase:prompt","component:mockup"],"design":"File: pkg/cli/mockup/prompt.tmpl. Go template referencing MockupPromptContext fields.","acceptance_criteria":"Template renders a well-structured agent prompt from MockupPromptContext data.","parentId":"SL-d4e5f6"}
{"id":"SL-b7c8d9","title":"T008: Implement MockupPromptContext builder (mockup/prompt.go)","description":"WHY: The prompt builder assembles all gathered context (spec content, components, framework, format) into a MockupPromptContext and renders the template to produce the final agent prompt string (FR-004, FR-017).\n\nDESIGN: Create pkg/cli/mockup/prompt.go with BuildMockupPrompt(ctx MockupPromptContext) (string, error). Load embedded prompt.tmpl, execute template with ctx, return rendered string. Add helper ConvertToPromptComponents(components []Component) []PromptComponent to convert Component structs to PromptComponent (format props as human-readable string). Use shared prompt.EstimateTokens and prompt.PrintTokenWarnings for the rendered prompt.\n\nACCEPTANCE: BuildMockupPrompt produces a complete agent prompt from MockupPromptContext. Token estimation is printed. Prompt includes all sections from the template.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/mockup/prompt.go created with BuildMockupPrompt\n[ ] ConvertToPromptComponents helper\n[ ] Template rendering via embedded prompt.tmpl\n[ ] Token estimation using shared prompt package\n[ ] Rendered prompt includes all template sections","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"BuildMockupPrompt function","checked":false},{"item":"ConvertToPromptComponents helper","checked":false},{"item":"Template rendering via embedded prompt.tmpl","checked":false},{"item":"Token estimation integration","checked":false},{"item":"Complete prompt output","checked":false}]},"blocked_by":["SL-0b1e92","SL-a7b8c9"],"blocks":["SL-b9c0d1","SL-d1e2f3"],"labels":["spec:598-mockup-command","phase:prompt","component:mockup","requirement:FR-004","requirement:FR-017"],"design":"File: pkg/cli/mockup/prompt.go. Uses embed for template, pkg/cli/prompt/ for token estimation.","acceptance_criteria":"BuildMockupPrompt produces a complete, well-structured agent prompt from context.","parentId":"SL-d4e5f6"}
{"id":"SL-b9c0d1","title":"T009: Add golden file tests for prompt generation","description":"WHY: Golden file tests verify that prompt output matches expected content for various contexts, catching regressions in template rendering.\n\nDESIGN: Create pkg/cli/mockup/prompt_test.go with TestBuildMockupPrompt_GoldenFiles. Create testdata/ directory with golden files: react_html.golden (React project, HTML format, multiple components), react_jsx.golden (React project, JSX format), vue_html.golden (Vue project), empty_components.golden (no components selected). Each test builds a MockupPromptContext, calls BuildMockupPrompt, and compares output to golden file. Use -update flag pattern for regenerating golden files.\n\nACCEPTANCE: Golden file tests pass. Tests cover React HTML, React JSX, Vue HTML, and empty component cases.\n\nDEFINITION OF DONE:\n[ ] pkg/cli/mockup/prompt_test.go with golden file tests\n[ ] testdata/ directory with 4 golden files\n[ ] Tests cover React HTML, React JSX, Vue HTML, empty components\n[ ] -update flag for regenerating golden files\n[ ] All tests pass","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Golden file tests in prompt_test.go","checked":false},{"item":"testdata/ with 4 golden files","checked":false},{"item":"React HTML, React JSX, Vue HTML, empty components covered","checked":false},{"item":"-update flag for regeneration","checked":false},{"item":"All tests pass","checked":false}]},"blocked_by":["SL-b7c8d9"],"labels":["spec:598-mockup-command","phase:prompt","component:mockup","test:unit"],"design":"File: pkg/cli/mockup/prompt_test.go, pkg/cli/mockup/testdata/*.golden. Table-driven golden file tests.","acceptance_criteria":"Golden file tests pass for all 4 contexts.","parentId":"SL-d4e5f6"}
{"id":"SL-a2b3c4","title":"T010: Wire spec resolution (arg / branch detection / picker)","description":"WHY: Spec-name is optional (FR-016). The system must resolve the spec from the CLI arg, auto-detect from branch, or present an interactive picker.\n\nDESIGN: In pkg/cli/commands/mockup.go runMockup handler, add spec resolution as step 1: 1) If args[0] provided, use directly. 2) If no arg, call issues.NewContextDetector(\".\").DetectSpecContext() to auto-detect from branch. 3) If auto-detect fails (not a feature branch), list available specs in specledger/ and present via huh.Select. 4) Validate specledger/<spec-name>/spec.md exists (exit 1 if not). Print resolved spec with lipgloss styling.\n\nACCEPTANCE: sl mockup 042-user-registration resolves directly. sl mockup on branch 598-mockup-command auto-detects. sl mockup on main shows picker. Missing spec shows error.\n\nDEFINITION OF DONE:\n[ ] Spec resolution from CLI arg\n[ ] Auto-detection from branch via issues.NewContextDetector\n[ ] Interactive picker via huh.Select when no arg and no feature branch\n[ ] Spec validation (exit 1 on missing)\n[ ] Lipgloss-styled resolution output","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Spec resolution from CLI arg","checked":false},{"item":"Branch auto-detection via issues.NewContextDetector","checked":false},{"item":"Interactive picker via huh.Select","checked":false},{"item":"Spec validation with exit code 1","checked":false},{"item":"Styled output","checked":false}]},"blocked_by":["SL-da1182"],"blocks":["SL-d5e6f7"],"labels":["spec:598-mockup-command","phase:interactive","story:US1","component:cli","requirement:FR-016"],"design":"File: pkg/cli/commands/mockup.go. Uses issues.NewContextDetector, huh.Select, lipgloss.","acceptance_criteria":"Spec resolved from arg, branch, or picker. Missing spec shows correct error.","parentId":"SL-f7a8b9"}
{"id":"SL-d5e6f7","title":"T011: Wire framework detection with interactive confirmation","description":"WHY: FR-019 requires interactive confirmation at framework detection step. Users should see the detected framework and confirm or override it.\n\nDESIGN: In runMockup handler, after spec resolution: 1) Call mockup.DetectFramework(\".\"). 2) Display result with lipgloss (framework name, confidence %). 3) If result.Ambiguous, present multiple frameworks via huh.Select. 4) If !result.IsFrontend && !mockupForceFlag, display styled error (exit 2). 5) If !result.IsFrontend && mockupForceFlag, warn and proceed with unknown. 6) huh.Confirm to accept detected framework (skip in --json mode). Handle monorepo patterns with directory suggestion.\n\nACCEPTANCE: React project shows 'Detected: React (95%)' with confirmation. Go project without --force shows error. Monorepo shows ambiguity picker.\n\nDEFINITION OF DONE:\n[ ] Framework displayed with lipgloss styling\n[ ] huh.Confirm for framework acceptance\n[ ] Ambiguous repo picker via huh.Select\n[ ] --force bypass with warning\n[ ] Non-frontend error with exit code 2\n[ ] Error messages match contracts/cli.md","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Lipgloss-styled framework display","checked":false},{"item":"huh.Confirm for acceptance","checked":false},{"item":"Ambiguous repo picker","checked":false},{"item":"--force bypass","checked":false},{"item":"Error messages match contracts","checked":false}]},"blocked_by":["SL-001c77","SL-a2b3c4"],"blocks":["SL-a8b9c0"],"labels":["spec:598-mockup-command","phase:interactive","story:US1","story:US3","component:cli","requirement:FR-001","requirement:FR-011","requirement:FR-019"],"design":"File: pkg/cli/commands/mockup.go. Uses mockup.DetectFramework, huh.Confirm/Select, lipgloss.","acceptance_criteria":"Detection shown with confirmation. --force works. Errors match contracts.","parentId":"SL-f7a8b9"}
{"id":"SL-a8b9c0","title":"T012: Wire design system check/generate with interactive prompts","description":"WHY: FR-019 requires interactive prompts for design system setup. If missing, the user should be prompted to generate it. If exists, show component count.\n\nDESIGN: In runMockup handler, after framework confirmation: 1) Check if specledger/design_system.md exists. 2) If exists: LoadDesignSystem, display component count with lipgloss. 3) If missing: huh.Confirm 'Generate design system now?' (default yes). If yes, call ScanComponents + InitializeDesignSystem, display scan stats. If no, proceed without design system (HasDesignSystem=false in context). 4) If exists but malformed: warn and offer to re-generate. Handle zero-component scan gracefully.\n\nACCEPTANCE: Existing design system loads and shows count. Missing design system prompts for generation. Malformed file offers re-generation.\n\nDEFINITION OF DONE:\n[ ] Design system existence check\n[ ] Lipgloss display of component count when loaded\n[ ] huh.Confirm for generation when missing\n[ ] Scan + write flow when generating\n[ ] Malformed file handling with re-generation offer\n[ ] Zero-component scan handled gracefully","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Design system load or generate flow","checked":false},{"item":"Interactive prompt when missing","checked":false},{"item":"Component count display","checked":false},{"item":"Malformed file handling","checked":false},{"item":"Zero-component graceful handling","checked":false}]},"blocked_by":["SL-9c05bf","SL-dd3052","SL-d5e6f7"],"blocks":["SL-d1e2f3"],"labels":["spec:598-mockup-command","phase:interactive","story:US1","story:US2","component:cli","requirement:FR-002","requirement:FR-005","requirement:FR-019"],"design":"File: pkg/cli/commands/mockup.go. Uses mockup.LoadDesignSystem, ScanComponents, InitializeDesignSystem, huh.Confirm, lipgloss.","acceptance_criteria":"Design system loaded or generated with interactive prompts. All edge cases handled.","parentId":"SL-f7a8b9"}
{"id":"SL-d1e2f3","title":"T013: Wire component multi-select and format selection","description":"WHY: FR-019 requires interactive selection of components and output format before generating the prompt.\n\nDESIGN: In runMockup handler, after design system setup: 1) Component multi-select: list all design system components via huh.MultiSelect, grouped by directory. All pre-selected by default. User deselects unwanted components. 2) Format selection: if --format flag set, use directly. If not, present huh.Select with html/jsx options. Store selected components and format for MockupPromptContext. If --json mode, skip interactive selects and use all components + flag values.\n\nACCEPTANCE: Component multi-select shows all components grouped by directory. Format select shows html/jsx options. --format flag bypasses select. --json mode uses defaults.\n\nDEFINITION OF DONE:\n[ ] huh.MultiSelect for component selection (grouped by directory)\n[ ] All components pre-selected by default\n[ ] huh.Select for format when --format not provided\n[ ] --format flag bypasses interactive select\n[ ] --json mode uses all components + flag values\n[ ] Selected data stored for MockupPromptContext","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Component multi-select with grouping","checked":false},{"item":"Pre-selected by default","checked":false},{"item":"Format select interactive","checked":false},{"item":"--format flag bypass","checked":false},{"item":"--json non-interactive path","checked":false}]},"blocked_by":["SL-b7c8d9","SL-a8b9c0"],"blocks":["SL-f4a5b6"],"labels":["spec:598-mockup-command","phase:interactive","story:US1","component:cli","requirement:FR-013","requirement:FR-019"],"design":"File: pkg/cli/commands/mockup.go. Uses huh.MultiSelect, huh.Select, lipgloss.","acceptance_criteria":"Component and format selection works interactively. Flags bypass selects.","parentId":"SL-f7a8b9"}
{"id":"SL-f4a5b6","title":"T014: Wire prompt generation, editor review, and action menu","description":"WHY: FR-017/FR-019 require the user to review the generated prompt in their editor before launching the agent. The action menu provides Launch/Re-edit/Write/Cancel options matching the revise pattern.\n\nDESIGN: In runMockup handler, after component/format selection: 1) Build MockupPromptContext from all gathered data. 2) Call mockup.BuildMockupPrompt(ctx) to render template. 3) Print token estimation via prompt.PrintTokenWarnings. 4) Open editor via prompt.EditPrompt(renderedPrompt). 5) Show action menu via huh.Select: Launch agent / Re-edit prompt / Write prompt to file / Cancel. Loop on Re-edit. Launch -> proceed to agent step. Write -> save to mockup-prompt.md, exit. Cancel -> clean exit. If --dry-run, skip editor and write directly to file.\n\nACCEPTANCE: Editor opens with rendered prompt. Action menu shows all 4 options. Re-edit loops back to editor. Write saves to file. Cancel exits cleanly. --dry-run skips to file write.\n\nDEFINITION OF DONE:\n[ ] MockupPromptContext built from gathered data\n[ ] BuildMockupPrompt renders template\n[ ] Token estimation printed\n[ ] prompt.EditPrompt opens editor\n[ ] Action menu with 4 options (Launch/Re-edit/Write/Cancel)\n[ ] Re-edit loops back to editor\n[ ] --dry-run writes prompt to file and exits\n[ ] Clean exit on Cancel","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"MockupPromptContext assembled","checked":false},{"item":"Template rendered via BuildMockupPrompt","checked":false},{"item":"Editor opens with prompt","checked":false},{"item":"4-option action menu","checked":false},{"item":"Re-edit loop","checked":false},{"item":"--dry-run file write","checked":false},{"item":"Clean Cancel exit","checked":false}]},"blocked_by":["SL-e6f7a8","SL-d1e2f3"],"blocks":["SL-c7d8e9"],"labels":["spec:598-mockup-command","phase:interactive","story:US1","component:cli","requirement:FR-014","requirement:FR-017","requirement:FR-019"],"design":"File: pkg/cli/commands/mockup.go. Uses pkg/cli/prompt/editor.go, mockup.BuildMockupPrompt, huh.Select.","acceptance_criteria":"Editor review and action menu work. --dry-run writes to file. Cancel exits cleanly.","parentId":"SL-f7a8b9"}
{"id":"SL-c7d8e9","title":"T015: Wire agent launch with fallback","description":"WHY: FR-017 requires launching the AI agent with the prompt. If no agent is available, fall back to writing the prompt to a file with install instructions.\n\nDESIGN: In runMockup handler, when user selects 'Launch agent': 1) Check SPECLEDGER_AGENT env var or iterate launcher.DefaultAgents. 2) For each agent, create launcher.NewAgentLauncher and check IsAvailable(). 3) If available, call LaunchWithPrompt(finalPrompt). 4) If no agent available, call writePromptToFile() and display agent.InstallInstructions(). Print agent name before launch. Handle agent launch errors gracefully.\n\nACCEPTANCE: Agent launches when available (Claude Code). Prompt written to file with install instructions when no agent. Error handling on launch failure.\n\nDEFINITION OF DONE:\n[ ] Agent detection via SPECLEDGER_AGENT or DefaultAgents\n[ ] launcher.LaunchWithPrompt called with prompt\n[ ] Fallback to writePromptToFile when no agent\n[ ] Install instructions displayed\n[ ] Launch error handling","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Agent detection from env or DefaultAgents","checked":false},{"item":"LaunchWithPrompt called","checked":false},{"item":"File fallback when no agent","checked":false},{"item":"Install instructions shown","checked":false},{"item":"Error handling on failure","checked":false}]},"blocked_by":["SL-f4a5b6"],"blocks":["SL-a0b1c2"],"labels":["spec:598-mockup-command","phase:interactive","story:US1","component:cli","requirement:FR-017"],"design":"File: pkg/cli/commands/mockup.go. Uses pkg/cli/launcher/ for agent detection and launch.","acceptance_criteria":"Agent launches with prompt. Fallback to file when unavailable. Errors handled.","parentId":"SL-f7a8b9"}
{"id":"SL-a0b1c2","title":"T016: Wire post-agent commit/push flow","description":"WHY: FR-018 requires offering to commit and push changes after the agent session completes, reusing the stagingAndCommitFlow pattern from revise.\n\nDESIGN: In runMockup handler, after agent session returns: 1) Check for changed files via cligit.GetChangedFiles(). 2) If no changes, print 'No changes detected' and skip. 3) If changes found, display summary. 4) Call stagingAndCommitFlow(cwd) or equivalent: huh.Confirm 'Commit and push?', file multi-select (all pre-selected), commit message input (default: 'feat: generate mockup for <spec-name>'), stage + commit + push. 5) Print summary with mockup path, format, components used. May extract stagingAndCommitFlow to a shared utility if not already.\n\nACCEPTANCE: Changed files detected after agent session. Commit/push flow works with file select and message. Summary printed. Skip if no changes.\n\nDEFINITION OF DONE:\n[ ] Changed file detection after agent session\n[ ] stagingAndCommitFlow pattern reused\n[ ] Default commit message for mockup\n[ ] Summary output with mockup path and format\n[ ] Skip gracefully when no changes","status":"open","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T18:00:00.000000+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Changed file detection","checked":false},{"item":"stagingAndCommitFlow reused","checked":false},{"item":"Default commit message","checked":false},{"item":"Summary output","checked":false},{"item":"No-changes skip","checked":false}]},"blocked_by":["SL-c7d8e9"],"labels":["spec:598-mockup-command","phase:interactive","story:US1","component:cli","requirement:FR-018"],"design":"File: pkg/cli/commands/mockup.go. Uses pkg/cli/git for changed files, stage, commit, push. Reuses stagingAndCommitFlow pattern.","acceptance_criteria":"Post-agent commit/push flow works. Summary shown. Handles no-changes case.","parentId":"SL-f7a8b9"}
{"id":"SL-354a9b","title":"T017: Implement sl mockup update subcommand handler","description":"WHY: US4 requires a separate sl mockup update command to refresh the design system index after components change (FR-012).\n\nDESIGN: In pkg/cli/commands/mockup.go, implement runMockupUpdate. Flow: 1) Check specledger/design_system.md exists (exit 1 if not). 2) Load existing design system. 3) huh.Confirm 'Rescan components?' (default yes, skip in --json mode). 4) Detect framework from loaded metadata. 5) Rescan components. 6) Call MergeDesignSystem. 7) Write updated file. Print stats: total, added, removed, scan duration.\n\nACCEPTANCE: sl mockup update rescans with interactive confirmation. Shows stats. Returns error when design_system.md missing.\n\nDEFINITION OF DONE:\n[ ] runMockupUpdate handler with interactive confirm\n[ ] Validates design_system.md exists (exit 1)\n[ ] huh.Confirm before rescan\n[ ] Rescan with stored framework type\n[ ] MergeDesignSystem called\n[ ] Stats output (added/removed/total/duration)","status":"open","priority":2,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:04:03.948947+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"runMockupUpdate with interactive confirm","checked":false},{"item":"Design system existence validation","checked":false},{"item":"Rescan with stored framework","checked":false},{"item":"MergeDesignSystem integration","checked":false},{"item":"Stats output","checked":false}]},"blocked_by":["SL-da1182","SL-dd3052"],"blocks":["SL-bf1ecc","SL-e17fc9"],"labels":["spec:598-mockup-command","phase:update","story:US4","component:cli","requirement:FR-012"],"design":"File: pkg/cli/commands/mockup.go. Uses huh.Confirm, mockup.LoadDesignSystem, ScanComponents, MergeDesignSystem.","acceptance_criteria":"sl mockup update rescans with confirm, shows stats, errors on missing file.","parentId":"SL-a00981"}
{"id":"SL-078da6","title":"T019: Add frontend detection to bootstrap.go init flow","description":"WHY: US5 requires sl init to auto-create design_system.md for frontend projects during onboarding (FR-006).\n\nDESIGN: In pkg/cli/commands/bootstrap.go, modify setupSpecLedgerProject(). After existing initialization steps: 1) Call mockup.DetectFramework(projectPath). 2) If result.IsFrontend: in interactive mode, prompt 'Initialize design system? [Y/n]' using huh.Confirm. Default yes. In CI mode, auto-create. 3) If yes, call mockup.InitializeDesignSystem(projectPath, result). 4) Print result with ui.Checkmark(). 5) If not frontend, skip silently.\n\nACCEPTANCE: sl init on a React project creates design_system.md. sl init on a Go project does NOT. Interactive prompt in TUI mode. CI mode auto-creates.\n\nDEFINITION OF DONE:\n[ ] Frontend detection in setupSpecLedgerProject\n[ ] huh.Confirm prompt for design system init\n[ ] Auto-create in CI/non-interactive mode\n[ ] Non-frontend projects skip silently\n[ ] Detection errors do not fail init","status":"open","priority":3,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:04:31.240735+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Frontend detection in bootstrap","checked":false},{"item":"Interactive prompt with Y/n default","checked":false},{"item":"Auto-create in CI mode","checked":false},{"item":"Non-frontend skip silently","checked":false},{"item":"Detection errors non-fatal","checked":false}]},"blocked_by":["SL-001c77","SL-dd3052"],"labels":["spec:598-mockup-command","phase:init","story:US5","component:cli","requirement:FR-006"],"design":"File: pkg/cli/commands/bootstrap.go (modify). Uses mockup.DetectFramework, huh.Confirm.","acceptance_criteria":"sl init creates design_system.md for frontend projects, skips for non-frontend.","parentId":"SL-b0f5d0"}
{"id":"SL-bf1ecc","title":"T020: Add --json non-interactive path for both commands","description":"WHY: --json flag enables CI/CD integration and machine-readable output. When set, skip all interactive prompts and output structured JSON.\n\nDESIGN: In runMockup, if mockupJSONFlag: skip all huh prompts, use flag values directly (all components, --format value), skip editor, launch agent directly (or --dry-run), collect results into JSON struct matching contracts/cli.md (status, framework, spec_name, mockup_path, prompt_path, format, design_system_created, components_scanned, components_selected, agent_launched, committed). In runMockupUpdate, if mockupJSONFlag: skip confirm, output JSON (status, components_total, added, removed, duration_ms). Suppress all non-JSON output.\n\nACCEPTANCE: sl mockup --json outputs valid JSON matching contracts/cli.md. sl mockup update --json outputs valid JSON. No non-JSON text.\n\nDEFINITION OF DONE:\n[ ] Non-interactive path when --json set\n[ ] JSON output for sl mockup matching contracts/cli.md\n[ ] JSON output for sl mockup update matching contracts/cli.md\n[ ] Non-JSON output suppressed\n[ ] Valid JSON parseable by jq","status":"open","priority":3,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:04:42.828261+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Non-interactive path for --json","checked":false},{"item":"JSON output for sl mockup","checked":false},{"item":"JSON output for sl mockup update","checked":false},{"item":"Non-JSON output suppressed","checked":false},{"item":"Valid jq-parseable JSON","checked":false}]},"blocked_by":["SL-a0b1c2","SL-354a9b"],"labels":["spec:598-mockup-command","phase:polish","component:cli"],"design":"File: pkg/cli/commands/mockup.go. Uses encoding/json MarshalIndent. Reference: contracts/cli.md JSON examples.","acceptance_criteria":"Both commands output valid JSON when --json flag set. No interactive prompts.","parentId":"SL-c71d1f"}
{"id":"SL-e17fc9","title":"T021: Comprehensive error handling and edge cases","description":"WHY: The spec defines edge cases that must be handled gracefully.\n\nDESIGN: Across pkg/cli/mockup/ and commands/mockup.go: 1) Empty/malformed design_system.md: LoadDesignSystem treats as missing, warns user, offers re-generation. 2) No user scenarios: ParseSpec returns error, handler prints contracts/cli.md error (exit 3). 3) No spec on branch and no arg: error message from contracts/cli.md. 4) Hundreds of components: grouped by directory in multi-select. 5) Write permission errors: catch os.ErrPermission (exit 4). 6) Agent not found: write prompt to file, show install instructions (exit 0, not error). 7) Mockup exists: huh.Confirm overwrite before proceeding. 8) User cancel at any step: clean exit code 0. 9) Agent launch failure: exit 6 with error. All error messages match contracts/cli.md.\n\nACCEPTANCE: Each edge case from spec.md is handled. Error messages match contracts. No panics.\n\nDEFINITION OF DONE:\n[ ] Malformed design system recovery\n[ ] No user scenarios error (exit 3)\n[ ] No spec on branch error\n[ ] Permission error handling (exit 4)\n[ ] Agent not found fallback\n[ ] Mockup exists overwrite confirmation\n[ ] Clean exit on user cancel\n[ ] Agent launch failure (exit 6)\n[ ] All error messages match contracts/cli.md","status":"open","priority":3,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:04:56.809165+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"Malformed design system recovery","checked":false},{"item":"No user scenarios error","checked":false},{"item":"No spec on branch error","checked":false},{"item":"Agent not found fallback","checked":false},{"item":"Mockup exists overwrite confirm","checked":false},{"item":"Clean exit on cancel","checked":false},{"item":"All error messages match contracts","checked":false}]},"blocked_by":["SL-a0b1c2","SL-354a9b"],"labels":["spec:598-mockup-command","phase:polish","component:mockup","component:cli"],"design":"Files: pkg/cli/mockup/*.go, pkg/cli/commands/mockup.go. Reference: spec.md Edge Cases, contracts/cli.md Error Messages.","acceptance_criteria":"All edge cases handled with correct messages and exit codes.","parentId":"SL-c71d1f"}
{"id":"SL-d47cb2","title":"T022: Unit tests for all domain modules","description":"WHY: Unit tests validate core domain logic in isolation.\n\nDESIGN: Create/update test files: 1) detector_test.go: table-driven tests for DetectFramework with fixtures for all frameworks + non-frontend + ambiguous. 2) scanner_test.go: per-framework scan tests with sample files, third-party detection, excluded dirs. 3) designsystem_test.go: load/write round-trip, merge with add/remove/preserve, manual markers. 4) specparser_test.go: ParseSpec with sample spec.md, empty spec error. 5) prompt_test.go: golden file tests (if not covered by T009). 6) pkg/cli/prompt/*_test.go: shared editor and prompt utility tests. Use t.TempDir() for filesystem fixtures.\n\nACCEPTANCE: All tests pass. go test ./pkg/cli/mockup/... and go test ./pkg/cli/prompt/... report no failures.\n\nDEFINITION OF DONE:\n[ ] detector_test.go with framework detection tests\n[ ] scanner_test.go with per-framework + third-party tests\n[ ] designsystem_test.go with round-trip + merge tests\n[ ] specparser_test.go with parse tests\n[ ] pkg/cli/prompt/ tests\n[ ] All tests pass","status":"open","priority":3,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:05:10.923437+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","definition_of_done":{"items":[{"item":"detector_test.go","checked":false},{"item":"scanner_test.go with third-party tests","checked":false},{"item":"designsystem_test.go with merge tests","checked":false},{"item":"specparser_test.go","checked":false},{"item":"prompt package tests","checked":false},{"item":"All tests pass","checked":false}]},"blocked_by":["SL-a0b1c2","SL-354a9b"],"labels":["spec:598-mockup-command","phase:polish","component:mockup","component:prompt","test:unit"],"design":"Files: pkg/cli/mockup/*_test.go, pkg/cli/prompt/*_test.go. Table-driven tests with t.TempDir().","acceptance_criteria":"All test files pass for mockup and prompt packages.","parentId":"SL-c71d1f"}
{"id":"SL-bdc5a2","title":"Implement mockup generator with ASCII screens [SUPERSEDED]","description":"SUPERSEDED. The AI agent now generates mockup content, not Go code. This task was replaced by T007 (prompt template) and T008 (prompt builder) in Phase 4.","status":"closed","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:02:42.408094+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","superseded"],"parentId":"SL-1e3e83"}
{"id":"SL-497332","title":"Wire sl mockup command handler with sequential flow [SUPERSEDED]","description":"SUPERSEDED. The non-interactive sequential handler was replaced by the 10-step interactive flow in Phase 5 (tasks T010-T016).","status":"closed","priority":1,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:02:59.158296+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","superseded"],"parentId":"SL-1e3e83"}
{"id":"SL-e55a8e","title":"Add auto-generation flow when design_system.md is missing [SUPERSEDED]","description":"SUPERSEDED. Auto-generation is now part of the interactive flow in T012 (design system check/generate with interactive prompts).","status":"closed","priority":2,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:03:13.755185+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","superseded"],"parentId":"SL-520c1b"}
{"id":"SL-632f43","title":"Add third-party library detection [SUPERSEDED]","description":"SUPERSEDED. Third-party library detection is now incorporated directly into T004 (component scanner) as part of the scanner's core functionality.","status":"closed","priority":2,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:03:27.626189+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","superseded"],"parentId":"SL-520c1b"}
{"id":"SL-87cce5","title":"Integrate frontend detection into mockup command [SUPERSEDED]","description":"SUPERSEDED. Detection integration with interactive confirmation is now T011 in Phase 5.","status":"closed","priority":2,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:03:40.906262+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","superseded"],"parentId":"SL-2b6615"}
{"id":"SL-e776d8","title":"Handle ambiguous repos and monorepo detection [SUPERSEDED]","description":"SUPERSEDED. Ambiguous repo handling is now incorporated into T003 (detector) and T011 (interactive confirmation).","status":"closed","priority":2,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:03:52.320466+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","superseded"],"parentId":"SL-2b6615"}
{"id":"SL-1033e3","title":"Add merge logic for design system updates [SUPERSEDED]","description":"SUPERSEDED. Merge logic is now incorporated directly into T005 (design system I/O) as MergeDesignSystem function.","status":"closed","priority":2,"issue_type":"task","spec_context":"598-mockup-command","created_at":"2026-02-27T10:04:17.832948+07:00","updated_at":"2026-02-27T18:00:00.000000+07:00","labels":["spec:598-mockup-command","superseded"],"parentId":"SL-a00981"}
