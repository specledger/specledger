{"id":"SL-aaf16e","title":"Advanced Agent Model Configuration","description":"WHY: Users want to control how agents are launched with configurable model providers, model names, base URLs, and auth tokens via persistent configuration instead of brittle shell aliases.","status":"open","priority":1,"issue_type":"epic","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:55:57.07048709Z","updated_at":"2026-02-26T07:55:57.07048709Z","labels":["spec:597-agent-model-config","component:cli"]}
{"id":"SL-a4323b","title":"Phase 1: Setup","description":"WHY: Establish shared infrastructure needed by all user stories - config file paths, data structures, and schema registry.","status":"open","priority":1,"issue_type":"feature","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:56:15.990099818Z","updated_at":"2026-02-26T08:02:35.178375309Z","blocks":["SL-27dcdd","SL-c85367","SL-209624","SL-b3a289"],"labels":["spec:597-agent-model-config","phase:setup","component:config"],"design":"Files: pkg/cli/config/schema.go (config key registry), pkg/cli/config/config.go (extend Config struct with AgentConfig). Define ConfigKeyDef struct with Key, Type, EnvVar, CLIFlag, Default, Sensitive, Description fields. Define AgentConfig struct with all agent fields (BaseURL, AuthToken, APIKey, Model, etc.) with yaml and sensitive struct tags.","parentId":"SL-aaf16e"}
{"id":"SL-27dcdd","title":"Phase 2: Foundational","description":"WHY: Blocking prerequisites that must complete before any user story can start - config merge logic, resolution, and launcher env injection.","status":"open","priority":1,"issue_type":"feature","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:56:52.101705021Z","updated_at":"2026-02-26T08:02:27.45225364Z","blocked_by":["SL-a4323b"],"blocks":["SL-c85367","SL-209624","SL-b3a289"],"labels":["spec:597-agent-model-config","phase:foundational","component:config"],"design":"Files: pkg/cli/config/merge.go (multi-layer config merge), pkg/cli/launcher/launcher.go (extend with BuildEnv method). Implement merge algorithm: defaults -\u003e global -\u003e profile -\u003e team-local -\u003e personal-local precedence. Add BuildEnv() to AgentLauncher to inject resolved config as environment variables.","parentId":"SL-aaf16e"}
{"id":"SL-209624","title":"US2: Local vs Global Configuration Hierarchy","description":"WHY: Multi-project support - developers work across different teams with different provider endpoints and need personal overrides alongside team-shared config.","status":"open","priority":2,"issue_type":"feature","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:56:52.109781855Z","updated_at":"2026-02-26T08:02:35.170887022Z","blocked_by":["SL-27dcdd","SL-a4323b"],"blocks":["SL-01f1c6"],"labels":["spec:597-agent-model-config","phase:us2","story:US2","component:config"],"design":"Files: pkg/cli/config/merge.go (extend for 3-tier hierarchy), pkg/cli/metadata/schema.go (extend ProjectMetadata with AgentConfig). Implement personal-local (specledger.local.yaml gitignored), team-local (specledger.yaml git-tracked), global (~/.specledger/config.yaml) scopes. Display scope indicators in sl config show output.","parentId":"SL-aaf16e"}
{"id":"SL-c85367","title":"US1: Configure Agent Model Overrides via CLI","description":"WHY: Core value - users need to persist agent launch configuration instead of manual shell aliases.","status":"open","priority":1,"issue_type":"feature","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:56:52.111690065Z","updated_at":"2026-02-26T08:02:27.425003605Z","blocked_by":["SL-a4323b","SL-27dcdd"],"blocks":["SL-01f1c6"],"labels":["spec:597-agent-model-config","phase:us1","story:US1","component:commands"],"design":"Files: pkg/cli/commands/config.go (sl config command with set/get/show/unset subcommands). Implement sl config set \u003ckey\u003e \u003cvalue\u003e, sl config get \u003ckey\u003e, sl config show, sl config unset \u003ckey\u003e. Support --global and --personal flags for scope targeting. Mask sensitive values in show output.","parentId":"SL-aaf16e"}
{"id":"SL-b3a289","title":"US3: Custom Agent Profiles","description":"WHY: Users need to switch between different AI provider configurations (work, personal, experimental) without re-running multiple config commands.","status":"open","priority":2,"issue_type":"feature","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:56:52.123057251Z","updated_at":"2026-02-26T08:02:35.178375443Z","blocked_by":["SL-27dcdd","SL-a4323b"],"blocks":["SL-01f1c6"],"labels":["spec:597-agent-model-config","phase:us3","story:US3","component:config"],"design":"Files: pkg/cli/config/profile.go (profile CRUD), pkg/cli/commands/config_profile.go (sl config profile subcommands). Implement sl config profile create/use/list/delete. Store profiles as map in config files. Track active-profile key. Profile values apply as merge layer.","parentId":"SL-aaf16e"}
{"id":"SL-01f1c6","title":"Phase 6: Polish \u0026 Cross-Cutting","description":"WHY: Integration validation, error handling, and documentation to complete the feature.","status":"open","priority":3,"issue_type":"feature","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:56:52.12824109Z","updated_at":"2026-02-26T08:02:27.455540665Z","blocked_by":["SL-c85367","SL-209624","SL-b3a289"],"labels":["spec:597-agent-model-config","phase:polish","component:docs"],"design":"Files: pkg/cli/commands/config_test.go (integration tests), docs updates. Add integration tests for config CLI commands. Validate error messages for invalid keys. Update README with config command documentation.","parentId":"SL-aaf16e"}
{"id":"SL-d420b1","title":"Define ConfigKeyDef struct and schema registry","description":"WHY: Need a centralized registry for config keys that maps keys to types, env vars, CLI flags, defaults, and validation rules.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:57:32.296438983Z","updated_at":"2026-02-26T07:57:32.296438983Z","definition_of_done":{"items":[{"item":"ConfigKeyDef struct compiles","checked":false},{"item":"ConfigKeyType enum has all 5 types","checked":false},{"item":"SchemaRegistry.Lookup returns key definition","checked":false},{"item":"All agent keys registered and queryable","checked":false}]},"labels":["spec:597-agent-model-config","phase:setup","component:config"],"design":"File: pkg/cli/config/schema.go. Define ConfigKeyDef struct with fields: Key (string), Type (ConfigKeyType enum), EnvVar (string), CLIFlag (string), Default (interface{}), Sensitive (bool), Description (string), EnumValues ([]string), Category (string). Define ConfigKeyType enum: string, bool, enum, string-list, string-map. Create SchemaRegistry with Register() and Lookup() methods. Register all agent config keys at init time.","acceptance_criteria":"ConfigKeyDef struct defined with all fields. ConfigKeyType enum defined. SchemaRegistry type with Register/Lookup methods. All 14 agent config keys registered at init.","parentId":"SL-a4323b"}
{"id":"SL-83aa12","title":"Define AgentConfig struct with all agent fields","description":"WHY: Need a Go struct to hold all agent configuration values with proper YAML mapping and sensitive field tagging.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:57:39.532713989Z","updated_at":"2026-02-26T08:02:48.650315447Z","definition_of_done":{"items":[{"item":"AgentConfig struct compiles","checked":false},{"item":"YAML serialization produces correct keys","checked":false},{"item":"sensitive:\"true\" tags on AuthToken and APIKey","checked":false}]},"blocks":["SL-0bb0d3"],"labels":["spec:597-agent-model-config","phase:setup","component:config"],"design":"File: pkg/cli/config/config.go. Define AgentConfig struct with fields: BaseURL, AuthToken (sensitive), APIKey (sensitive), Model, ModelSonnet, ModelOpus, ModelHaiku, SubagentModel, Provider (enum), PermissionMode (enum), SkipPermissions (bool), Effort (enum), AllowedTools ([]string), Env (map[string]string). Use yaml struct tags for YAML key mapping. Use sensitive struct tag for AuthToken and APIKey.","acceptance_criteria":"AgentConfig struct defined with all 15 fields. YAML tags map to data-model.md spec. Sensitive fields tagged with sensitive:\"true\". Struct compiles and serializes to YAML correctly.","parentId":"SL-a4323b"}
{"id":"SL-0bb0d3","title":"Extend Config struct with Agent and Profiles fields","description":"WHY: Global config file needs to store agent configuration and named profiles alongside existing settings.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:57:39.540394621Z","updated_at":"2026-02-26T08:02:48.650315619Z","definition_of_done":{"items":[{"item":"Config struct extended","checked":false},{"item":"Load() handles missing Agent field gracefully","checked":false},{"item":"Save() writes new fields to YAML","checked":false}]},"blocked_by":["SL-83aa12"],"labels":["spec:597-agent-model-config","phase:setup","component:config"],"design":"File: pkg/cli/config/config.go. Add fields to existing Config struct: Agent (AgentConfig), Profiles (map[string]AgentConfig), ActiveProfile (string). Ensure backward compatibility with existing config files (missing fields use zero values). Update Load() and Save() to handle new fields.","acceptance_criteria":"Config struct has Agent, Profiles, ActiveProfile fields. Existing config files load without errors. New fields serialize to YAML correctly.","parentId":"SL-a4323b"}
{"id":"SL-6ba412","title":"Implement config merge logic","description":"WHY: Need to merge configuration from multiple layers (defaults, global, profile, team-local, personal-local) with correct precedence.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:58:13.674572179Z","updated_at":"2026-02-26T08:02:48.676022264Z","definition_of_done":{"items":[{"item":"MergeConfigs function implemented","checked":false},{"item":"Precedence order verified with tests","checked":false},{"item":"ResolvedConfig/ResolvedValue structs defined","checked":false},{"item":"Source tracking works for each layer","checked":false}]},"blocks":["SL-0a932f"],"labels":["spec:597-agent-model-config","phase:foundational","component:config"],"design":"File: pkg/cli/config/merge.go. Implement MergeConfigs(defaults, global, profile, teamLocal, personalLocal AgentConfig) function. Merge algorithm: start with defaults, overlay non-zero values from each layer in precedence order. Only non-zero/non-empty values override. Return ResolvedConfig with Values map and scope tracking. Create ResolvedValue struct with Key, Value, Source, Sensitive fields.","acceptance_criteria":"MergeConfigs function merges 5 layers correctly. Precedence order: personal-local \u003e team-local \u003e profile \u003e global \u003e default. ResolvedConfig contains merged values with source tracking. Empty/zero values do not override.","parentId":"SL-27dcdd"}
{"id":"SL-cc22d9","title":"Add BuildEnv method to AgentLauncher","description":"WHY: Agent subprocess needs to receive configured environment variables at launch time.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:58:13.685750587Z","updated_at":"2026-02-26T08:02:48.690907837Z","definition_of_done":{"items":[{"item":"SetEnv method added to AgentLauncher","checked":false},{"item":"BuildEnv method returns correct env slice","checked":false},{"item":"Launch() uses cmd.Env = l.BuildEnv()","checked":false},{"item":"Config values take precedence over os.Environ()","checked":false}]},"blocks":["SL-0a932f"],"labels":["spec:597-agent-model-config","phase:foundational","component:launcher"],"design":"File: pkg/cli/launcher/launcher.go. Add SetEnv(envVars map[string]string) method to AgentLauncher. Add BuildEnv() []string method that returns os.Environ() with config overrides appended. Modify Launch() to set cmd.Env = l.BuildEnv() before cmd.Run(). Config-derived env vars take precedence over existing environment.","acceptance_criteria":"BuildEnv() returns environment slice with config values. Launch() injects env vars into subprocess. Config values override existing env vars with same name. Existing launches continue to work.","parentId":"SL-27dcdd"}
{"id":"SL-e1df13","title":"Extend ProjectMetadata with AgentConfig","description":"WHY: Project-level (team-local) configuration needs to store agent settings in specledger.yaml.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:58:13.688696987Z","updated_at":"2026-02-26T07:58:13.688696987Z","definition_of_done":{"items":[{"item":"ProjectMetadata struct extended","checked":false},{"item":"Load() handles missing Agent field gracefully","checked":false},{"item":"Save() writes new fields to YAML","checked":false}]},"labels":["spec:597-agent-model-config","phase:foundational","component:metadata"],"design":"File: pkg/cli/metadata/schema.go. Add Agent (AgentConfig), Profiles (map[string]AgentConfig), ActiveProfile (string) fields to ProjectMetadata struct. Ensure backward compatibility with existing project files. Update Load() and Save() methods if needed.","acceptance_criteria":"ProjectMetadata has Agent, Profiles, ActiveProfile fields. Existing specledger.yaml files load without errors. New fields serialize to YAML correctly.","parentId":"SL-27dcdd"}
{"id":"SL-e10d8a","title":"Implement sl config command with set/get/show/unset","description":"WHY: Users need CLI commands to manage agent configuration values.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:59:37.571341277Z","updated_at":"2026-02-26T08:02:59.867653188Z","definition_of_done":{"items":[{"item":"sl config set \u003ckey\u003e \u003cvalue\u003e stores value","checked":false},{"item":"sl config get \u003ckey\u003e returns value","checked":false},{"item":"sl config show displays all values with scope","checked":false},{"item":"sl config unset \u003ckey\u003e removes value","checked":false},{"item":"Invalid keys show helpful error message","checked":false}]},"blocks":["SL-342cd4","SL-24a33c"],"labels":["spec:597-agent-model-config","phase:us1","story:US1","component:commands","fr:FR-003"],"design":"File: pkg/cli/commands/config.go. Create ConfigCmd with subcommands: SetCmd, GetCmd, ShowCmd, UnsetCmd. SetCmd: sl config set \u003ckey\u003e \u003cvalue\u003e stores value in config. GetCmd: sl config get \u003ckey\u003e displays single value. ShowCmd: sl config show displays all config with scope indicators. UnsetCmd: sl config unset \u003ckey\u003e removes value. Register command in cmd/sl/main.go.","acceptance_criteria":"sl config set/get/show/unset commands work. Values persist across CLI invocations. Invalid keys rejected with helpful error. sl config show displays scope indicators.","parentId":"SL-c85367"}
{"id":"SL-342cd4","title":"Add --global and --personal scope flags to config set/unset","description":"WHY: Users need to target specific config scopes (global user-wide, personal gitignored, or team-local default).","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:59:37.583807396Z","updated_at":"2026-02-26T08:02:48.658670257Z","definition_of_done":{"items":[{"item":"--global flag works","checked":false},{"item":"--personal flag works","checked":false},{"item":"Default targets team-local scope","checked":false},{"item":"Scope indicator correct in show output","checked":false}]},"blocked_by":["SL-e10d8a"],"labels":["spec:597-agent-model-config","phase:us1","story:US1","component:commands","fr:FR-004"],"design":"File: pkg/cli/commands/config.go. Add --global flag to target ~/.specledger/config.yaml. Add --personal flag to target specledger/specledger.local.yaml (gitignored). Default (no flag) targets specledger/specledger.yaml (team-local). Pass scope to config Set/Unset functions.","acceptance_criteria":"--global flag stores to global config. --personal flag stores to gitignored local config. Default stores to team-local config. Scope correctly displayed in sl config show.","parentId":"SL-c85367"}
{"id":"SL-24a33c","title":"Mask sensitive values in sl config show output","description":"WHY: Auth tokens and API keys should not be displayed in full in terminal output.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:59:37.586537062Z","updated_at":"2026-02-26T08:02:59.867653321Z","definition_of_done":{"items":[{"item":"auth-token displays masked","checked":false},{"item":"api-key displays masked","checked":false},{"item":"Non-sensitive values display in full","checked":false}]},"blocked_by":["SL-e10d8a"],"labels":["spec:597-agent-model-config","phase:us1","story:US1","component:commands","fr:FR-005"],"design":"File: pkg/cli/commands/config.go. In ShowCmd, check if key is marked sensitive in schema registry. If sensitive, display ****[last4] (last 4 characters visible). Use ResolvedValue.Sensitive field from merge logic.","acceptance_criteria":"Sensitive values display as ****[last4] in sl config show. Non-sensitive values display normally. Last 4 characters visible for verification.","parentId":"SL-c85367"}
{"id":"SL-eb3d1b","title":"Store sensitive values with restricted file permissions","description":"WHY: Auth tokens and API keys need secure file permissions (owner read/write only).","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:59:37.594271394Z","updated_at":"2026-02-26T07:59:37.594271394Z","definition_of_done":{"items":[{"item":"Global config file has 0600 permissions","checked":false},{"item":"Personal-local config has 0600 permissions","checked":false}]},"labels":["spec:597-agent-model-config","phase:us1","story:US1","component:config","fr:FR-006"],"design":"File: pkg/cli/config/config.go. When saving config file containing sensitive values, set file permissions to 0600 (owner read/write only). Use os.Chmod() after file write. Applies to global config and personal-local config files.","acceptance_criteria":"Config files with sensitive values have 0600 permissions. New files created with 0600. Existing files updated on save.","parentId":"SL-c85367"}
{"id":"SL-0a932f","title":"Integrate resolved config with agent launcher","description":"WHY: Agent subprocess must receive configured environment variables at launch time.","status":"open","priority":1,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T07:59:37.5968244Z","updated_at":"2026-02-26T08:02:48.690908023Z","definition_of_done":{"items":[{"item":"sl new uses resolved config","checked":false},{"item":"sl init uses resolved config","checked":false},{"item":"Env vars injected into agent subprocess","checked":false}]},"blocked_by":["SL-6ba412","SL-cc22d9"],"labels":["spec:597-agent-model-config","phase:us1","story:US1","component:launcher","fr:FR-007"],"design":"File: pkg/cli/commands/bootstrap_helpers.go. In launchAgent(), resolve config using merge logic. Call launcher.SetEnv() with resolved env vars before Launch(). Ensure sl new and sl init both use resolved config.","acceptance_criteria":"sl new launches agent with configured env vars. sl init launches agent with configured env vars. Config values override existing env vars. Agent receives ANTHROPIC_* env vars correctly.","parentId":"SL-c85367"}
{"id":"SL-1dd93a","title":"Create specledger.local.yaml personal override file support","description":"WHY: Users need gitignored personal project overrides for settings like auth tokens that should not be shared with team.","status":"open","priority":2,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:00:08.01199284Z","updated_at":"2026-02-26T08:00:08.01199284Z","definition_of_done":{"items":[{"item":"LoadPersonal() reads specledger.local.yaml","checked":false},{"item":"SavePersonal() writes specledger.local.yaml","checked":false},{"item":"File added to .gitignore","checked":false}]},"labels":["spec:597-agent-model-config","phase:us2","story:US2","component:config","fr:FR-002"],"design":"File: pkg/cli/config/personal.go. Define PersonalConfig struct matching AgentConfig subset. Implement LoadPersonal() and SavePersonal() for specledger/specledger.local.yaml. Add .local.yaml to default .gitignore template. File path: specledger/specledger.local.yaml.","acceptance_criteria":"specledger.local.yaml loads correctly. File is gitignored by default. Personal values merge with team-local values. Personal takes precedence over team-local.","parentId":"SL-209624"}
{"id":"SL-148bce","title":"Display scope indicators in sl config show","description":"WHY: Users need to see where each config value comes from (global, local, personal, profile, or default).","status":"open","priority":2,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:00:08.018194433Z","updated_at":"2026-02-26T08:00:08.018194433Z","definition_of_done":{"items":[{"item":"Scope indicators display correctly","checked":false},{"item":"All 5 scope types supported","checked":false}]},"labels":["spec:597-agent-model-config","phase:us2","story:US2","component:commands","fr:FR-008"],"design":"File: pkg/cli/commands/config.go. Enhance ShowCmd to display scope indicator [global], [local], [personal], [profile:name], or [default] for each value. Use ResolvedValue.Source from merge logic. Format: key value [scope].","acceptance_criteria":"sl config show displays scope for each value. Global values show [global]. Team-local values show [local]. Personal values show [personal]. Default values show [default].","parentId":"SL-209624"}
{"id":"SL-5faa9a","title":"Add warning for sensitive values in git-tracked scope","description":"WHY: CLI should warn users when storing sensitive values in team-local (git-tracked) scope without --personal.","status":"open","priority":2,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:00:08.020983007Z","updated_at":"2026-02-26T08:00:08.020983007Z","definition_of_done":{"items":[{"item":"Warning displays for auth-token in team-local","checked":false},{"item":"Warning displays for api-key in team-local","checked":false},{"item":"Warning recommends --personal flag","checked":false}]},"labels":["spec:597-agent-model-config","phase:us2","story:US2","component:commands"],"design":"File: pkg/cli/commands/config.go. In SetCmd, check if key is sensitive and scope is team-local (no --personal flag). If so, print warning recommending --personal. User can proceed (no --force required). Warning shown every time.","acceptance_criteria":"Warning shown when sensitive value stored without --personal. Warning message recommends --personal flag. User can still proceed with team-local storage.","parentId":"SL-209624"}
{"id":"SL-3c69b4","title":"Implement profile CRUD operations","description":"WHY: Users need to create, list, and delete named agent configuration profiles.","status":"open","priority":2,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:00:53.180852948Z","updated_at":"2026-02-26T08:02:48.686377369Z","definition_of_done":{"items":[{"item":"CreateProfile stores profile in map","checked":false},{"item":"DeleteProfile removes from map","checked":false},{"item":"ListProfiles returns all names","checked":false},{"item":"GetProfile returns AgentConfig","checked":false}]},"blocks":["SL-f0d996","SL-b27eef"],"labels":["spec:597-agent-model-config","phase:us3","story:US3","component:config","fr:FR-011"],"design":"File: pkg/cli/config/profile.go. Implement CreateProfile(name string, agent AgentConfig) error. Implement DeleteProfile(name string) error. Implement ListProfiles() []string. Implement GetProfile(name string) AgentConfig. Profiles stored in Config.Profiles map. Active profile tracked in Config.ActiveProfile.","acceptance_criteria":"Profiles can be created and stored. Profiles can be listed. Profiles can be deleted. Active profile tracked correctly.","parentId":"SL-b3a289"}
{"id":"SL-f0d996","title":"Implement sl config profile subcommands","description":"WHY: Users need CLI commands to manage profiles - create, use, list, delete.","status":"open","priority":2,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:00:53.191551399Z","updated_at":"2026-02-26T08:02:48.671224143Z","definition_of_done":{"items":[{"item":"profile create works","checked":false},{"item":"profile use activates","checked":false},{"item":"profile list shows all","checked":false},{"item":"profile delete removes","checked":false},{"item":"profile use --none deactivates","checked":false}]},"blocked_by":["SL-3c69b4"],"labels":["spec:597-agent-model-config","phase:us3","story:US3","component:commands","fr:FR-011"],"design":"File: pkg/cli/commands/config_profile.go. Create ProfileCmd with subcommands: CreateCmd (sl config profile create \u003cname\u003e), UseCmd (sl config profile use \u003cname\u003e), ListCmd (sl config profile list), DeleteCmd (sl config profile delete \u003cname\u003e). UseCmd with --none flag deactivates all profiles. ListCmd highlights active profile.","acceptance_criteria":"sl config profile create creates new profile. sl config profile use activates profile. sl config profile list shows all profiles with active highlighted. sl config profile delete removes profile. sl config profile use --none deactivates.","parentId":"SL-b3a289"}
{"id":"SL-56531a","title":"Implement agent.env arbitrary environment variable support","description":"WHY: Users need to inject custom environment variables beyond the predefined config keys.","status":"open","priority":2,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:00:53.197383218Z","updated_at":"2026-02-26T08:00:53.197383218Z","definition_of_done":{"items":[{"item":"agent.env.KEY set works","checked":false},{"item":"agent.env unset KEY works","checked":false},{"item":"Env vars shown in sl config show","checked":false},{"item":"Env vars injected at launch","checked":false}]},"labels":["spec:597-agent-model-config","phase:us3","story:US3","component:config","fr:FR-007a"],"design":"File: pkg/cli/config/config.go, pkg/cli/commands/config.go. AgentConfig.Env is map[string]string. sl config set agent.env.KEY VALUE stores in map. sl config show displays agent.env entries indented under agent.env. BuildEnv() injects all Env map entries as env vars.","acceptance_criteria":"agent.env.KEY set stores in map. sl config show displays env vars grouped. Env vars injected into agent subprocess.","parentId":"SL-b3a289"}
{"id":"SL-b27eef","title":"Integrate profile values into config merge","description":"WHY: Active profile values must be merged with other config layers at resolution time.","status":"open","priority":2,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:01:05.148247349Z","updated_at":"2026-02-26T08:02:48.686377529Z","definition_of_done":{"items":[{"item":"Profile values merged","checked":false},{"item":"Precedence correct","checked":false},{"item":"Scope indicator shows profile name","checked":false}]},"blocked_by":["SL-3c69b4"],"labels":["spec:597-agent-model-config","phase:us3","story:US3","component:config"],"design":"File: pkg/cli/config/merge.go. Extend MergeConfigs to accept active profile name. If profile active, lookup profile AgentConfig and insert as merge layer between global and team-local. Precedence: personal-local \u003e team-local \u003e profile \u003e global \u003e default.","acceptance_criteria":"Active profile values merged correctly. Profile layer between global and team-local. Profile values shown with [profile:name] scope indicator. Switching profiles updates resolved config.","parentId":"SL-b3a289"}
{"id":"SL-fe787f","title":"Add integration tests for config CLI commands","description":"WHY: Need automated tests to verify config command behavior end-to-end.","status":"open","priority":3,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:01:43.006228654Z","updated_at":"2026-02-26T08:01:43.006228654Z","definition_of_done":{"items":[{"item":"TestSetGet tests set/get roundtrip","checked":false},{"item":"TestScopeFlags tests --global/--personal","checked":false},{"item":"TestSensitiveMasking tests value masking","checked":false},{"item":"TestProfileCRUD tests profile operations","checked":false}]},"labels":["spec:597-agent-model-config","phase:polish","test:integration"],"design":"File: pkg/cli/commands/config_test.go. Test cases: set/get roundtrip, scope targeting, sensitive masking, profile CRUD, merge precedence. Use temp directories for test config files.","acceptance_criteria":"Integration tests cover all config commands. Tests pass with go test. Test coverage for happy paths and error cases.","parentId":"SL-01f1c6"}
{"id":"SL-e910b0","title":"Add unit tests for config merge logic","description":"WHY: Need unit tests to verify merge precedence and edge cases.","status":"open","priority":3,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:01:43.014772728Z","updated_at":"2026-02-26T08:01:43.014772728Z","definition_of_done":{"items":[{"item":"TestDefaultOnly verifies base case","checked":false},{"item":"TestPrecedenceOrder verifies layer order","checked":false},{"item":"TestEmptyLayerHandling verifies graceful handling","checked":false}]},"labels":["spec:597-agent-model-config","phase:polish","test:unit"],"design":"File: pkg/cli/config/merge_test.go. Test cases: default only, global override, profile layer, team-local override, personal-local override, full 5-layer merge, empty layer handling, zero value handling.","acceptance_criteria":"Unit tests cover all merge scenarios. Precedence order verified. Edge cases tested (empty configs, zero values).","parentId":"SL-01f1c6"}
{"id":"SL-880f52","title":"Update README with config command documentation","description":"WHY: Users need documentation for the new sl config commands.","status":"open","priority":3,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:01:43.02190236Z","updated_at":"2026-02-26T08:01:43.02190236Z","definition_of_done":{"items":[{"item":"sl config commands documented","checked":false},{"item":"Examples for each subcommand","checked":false},{"item":"Scope flags explained","checked":false},{"item":"Config key table included","checked":false}]},"labels":["spec:597-agent-model-config","phase:polish","component:docs"],"design":"File: README.md. Add Configuration section with: sl config set/get/show/unset examples, scope flags explanation, profile usage, config key reference table, sensitive value handling notes.","acceptance_criteria":"README documents all config commands. Examples provided for common use cases. Config key reference table included.","parentId":"SL-01f1c6"}
{"id":"SL-0b50c9","title":"Add config key validation with helpful errors","description":"WHY: Users need clear error messages when setting invalid config keys.","status":"open","priority":3,"issue_type":"task","spec_context":"597-agent-model-config","created_at":"2026-02-26T08:01:55.251769377Z","updated_at":"2026-02-26T08:01:55.251769377Z","definition_of_done":{"items":[{"item":"Invalid key shows error","checked":false},{"item":"Valid keys listed in error","checked":false},{"item":"Typo suggestion works","checked":false}]},"labels":["spec:597-agent-model-config","phase:polish","component:commands","fr:FR-012"],"design":"File: pkg/cli/commands/config.go. In SetCmd, validate key against schema registry before setting. If key unknown, show error with list of valid keys grouped by category. Suggest similar keys if typo detected.","acceptance_criteria":"Invalid keys rejected with error. Error message lists valid keys. Typo detection suggests similar keys.","parentId":"SL-01f1c6"}
